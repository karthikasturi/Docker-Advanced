# Comparison of Seccomp, AppArmor, and Linux Capabilities

Understanding how **Seccomp**, **AppArmor**, and **Linux Capabilities** work together is key to securing containers. Below is a detailed comparison and analogy to clarify their roles and differences.

## Feature Comparison

| Feature                | What It Controls                             | Scope of Control             | Enforced By | Format / Type              |
| ---------------------- | -------------------------------------------- | ---------------------------- | ----------- | -------------------------- |
| **Linux Capabilities** | Fine-grained kernel-level privileges         | Process privileges           | Kernel      | Predefined capability list |
| **Seccomp**            | System calls a process can make              | Syscall filtering            | Kernel      | JSON (BPF filter)          |
| **AppArmor**           | Access to filesystem, network, and execution | File/path-level restrictions | Kernel      | Text profile (path-based)  |

## Analogy: The Courier and the Office Building

Imagine a **courier delivering packages** in a secured office building.

| Layer            | Analogy                                      | What It Controls                              |
| ---------------- | -------------------------------------------- | --------------------------------------------- |
| **Capabilities** | What tasks the courier is allowed to perform | e.g., "can open locked doors", "use elevator" |
| **Seccomp**      | What tools the courier is allowed to use     | e.g., "can use phone", "can scan documents"   |
| **AppArmor**     | Where the courier is allowed to go           | e.g., "can only access mailroom and hallway"  |

These layers work **together** to minimize attack surface and enforce least privilege.

## Docker Integration

```bash
docker run \
  --cap-drop=ALL \
  --cap-add=NET_BIND_SERVICE \
  --security-opt seccomp=/fullpath/custom.json \
  --security-opt apparmor=docker-default \
  myapp
```

This configuration:

- Drops all Linux capabilities and re-adds only what's needed.
- Applies syscall filtering via Seccomp.
- Restricts file/path access via AppArmor.

## Summary Table

| Feature      | Kernel-Level | Scope       | Use Case                         | Configuration    |
| ------------ | ------------ | ----------- | -------------------------------- | ---------------- |
| Capabilities | ✅ Yes        | Privileges  | Drop root-like permissions       | `--cap-add/drop` |
| Seccomp      | ✅ Yes        | Syscalls    | Block dangerous kernel APIs      | JSON profile     |
| AppArmor     | ✅ Yes        | Files/Paths | Restrict file and network access | AppArmor profile |

## Best Practice

Use all three together for defense-in-depth:

- Capabilities for privilege minimization
- Seccomp for syscall restriction
- AppArmor for access control