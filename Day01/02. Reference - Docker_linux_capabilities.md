# Linux Capabilities in Docker

Linux capabilities allow you to assign fine-grained privileges to processes in containers, without needing full root privileges.

## List of Docker Linux Capabilities

| Capability               | Description                                                 |
| ------------------------ | ----------------------------------------------------------- |
| `CAP_AUDIT_CONTROL`      | Enable and disable kernel auditing; change audit filters    |
| `CAP_AUDIT_READ`         | Read audit logs via multicast netlink socket                |
| `CAP_AUDIT_WRITE`        | Write records to kernel auditing log                        |
| `CAP_BLOCK_SUSPEND`      | Use features that can block system suspend                  |
| `CAP_BPF`                | Load BPF programs, manage maps and perf events              |
| `CAP_CHECKPOINT_RESTORE` | Checkpoint and restore processes (CRIU)                     |
| `CAP_CHOWN`              | Change file ownership (user/group)                          |
| `CAP_DAC_OVERRIDE`       | Bypass file read/write/execute permission checks            |
| `CAP_DAC_READ_SEARCH`    | Bypass file and directory read/search checks                |
| `CAP_FOWNER`             | Bypass ownership checks on files                            |
| `CAP_FSETID`             | Allow setting file’s setuid/setgid bits                     |
| `CAP_IPC_LOCK`           | Lock memory segments                                        |
| `CAP_IPC_OWNER`          | Bypass IPC permission checks                                |
| `CAP_KILL`               | Send signals to any process                                 |
| `CAP_LEASE`              | Take/modify leases on files                                 |
| `CAP_LINUX_IMMUTABLE`    | Set the immutable flag on files                             |
| `CAP_MAC_ADMIN`          | Modify MAC (Mandatory Access Control) configuration         |
| `CAP_MAC_OVERRIDE`       | Bypass MAC access checks                                    |
| `CAP_MKNOD`              | Create special files using mknod                            |
| `CAP_NET_ADMIN`          | Configure interfaces, routing, firewall, etc.               |
| `CAP_NET_BIND_SERVICE`   | Bind to ports below 1024                                    |
| `CAP_NET_BROADCAST`      | Broadcast, multicast                                        |
| `CAP_NET_RAW`            | Use raw and packet sockets                                  |
| `CAP_PERFMON`            | Use performance monitoring features                         |
| `CAP_SETFCAP`            | Set file capabilities                                       |
| `CAP_SETGID`             | Set group ID                                                |
| `CAP_SETPCAP`            | Transfer capabilities                                       |
| `CAP_SETUID`             | Set user ID                                                 |
| `CAP_SYS_ADMIN`          | Almost everything (mount, pivot_root, etc.) — very powerful |
| `CAP_SYS_BOOT`           | Use reboot()                                                |
| `CAP_SYS_CHROOT`         | Use chroot()                                                |
| `CAP_SYS_MODULE`         | Load/unload kernel modules                                  |
| `CAP_SYS_NICE`           | Increase process priority                                   |
| `CAP_SYS_PACCT`          | Process accounting                                          |
| `CAP_SYS_PTRACE`         | Trace any process                                           |
| `CAP_SYS_RAWIO`          | Direct memory access to hardware                            |
| `CAP_SYS_RESOURCE`       | Override resource limits                                    |
| `CAP_SYS_TIME`           | Set system clock                                            |
| `CAP_SYS_TTY_CONFIG`     | Configure tty devices                                       |
| `CAP_SYSLOG`             | Use syslog                                                  |
| `CAP_WAKE_ALARM`         | Trigger wakeup alarms                                       |

## Dangerous Capabilities to Avoid

| Capability       | Why it’s risky                                     |
| ---------------- | -------------------------------------------------- |
| `CAP_SYS_ADMIN`  | Can override most kernel restrictions              |
| `CAP_NET_ADMIN`  | Can manipulate networking, sniff traffic           |
| `CAP_SYS_MODULE` | Can load kernel modules                            |
| `CAP_SYS_PTRACE` | Can inspect other processes (useful for attackers) |

## View Default Capabilities in Docker

```bash
docker run --rm alpine sh -c "capsh --print"
```

To drop all and add selectively:

```bash
docker run --cap-drop=ALL --cap-add=NET_BIND_SERVICE alpine
```

## Best Practices

- Start with `--cap-drop=ALL`
- Add only what you explicitly need via `--cap-add`
- Use `--security-opt no-new-privileges` to prevent privilege escalation